{"version":3,"sources":["core.js","controllers/chatController.js","controllers/forgotController.js","controllers/submitController.js","directives/sy-autofocus.js","directives/sy-autoscroll.js","directives/sy-beep.js","directives/sy-hideKeyboard.js","directives/sy-imageonload.js","directives/sy-img.js","directives/sy-msgNotify.js","directives/sy-usercount.js","services/sy-geoHelper.js","services/sy-msgHelper.js","services/sy-posHelper.js","services/sy-timeHelper.js"],"names":["angular","module","config","$routeProvider","$locationProvider","$httpProvider","jwtInterceptorProvider","html5Mode","when","templateUrl","controller","otherwise","redirectTo","tokenGetter","store","get","interceptors","push","$rootScope","$scope","$timeout","$location","$route","$window","jwtHelper","detectmob","ua","navigator","userAgent","match","isMobile","standalone","console","log","$on","event","current","pre","next","path","isTokenExpired","replace","msg","$broadcast","$http","$filter","syPosHelper","syTimeHelper","syGeoHelper","syMsgHelper","getSelectedDateNews","callback","post","selectDate","timezoneOffset","success","data","status","headers","error","onTextMsg","isMe","socket","id","isBottom","isScrollDown","$apply","msgInbox","isImg","img_list","length","isShowDate","date","msgSanitization","username","imgSanitization","isChatBox","scrollToPos","at","indexOf","decodeToken","msgNotify","contentItem","msgPosInfo","topPos","getElemTopPos","bottomPos","getElemBottomPos","connectSIO","io","query","token","on","emit","data_len","i","onUserIO","reconnectSIO","disconnect","connect","isSun","getDaytimeOrNight","Date","getHours","isInfoBox","toggleChatBox","action","currentPage","toggleCurrentPage","now_img_list","isZoomIn","name","infoBox","title","numero","partsOfADay","weather","description","getNumero","partWeather","togglePartWeather","getCityWeatherType","code","isNewsExist","toggleNewsExist","newsBox","selectDateNewsBox","getTimezoneOffset","news","previousHour","nextHour","gotoSettingBox","isMuted","toggleMuted","set","quit","remove","isGeoServices","toggleGeoServices","$emit","geoBox","weatherBox","isSameDay","getGeoServices","distance","geolocation","getCurrentPosition","pos","coords","latitude","longitude","lat","lon","last_code","last_geo","last_isNight","isNight","now_code","now_geo","now_isNight","last_weather","getGeoWeatherType","now_weather","getDistance","atUser","isUserOnline","onlineUser","slice","$watch","newVal","oldVal","at_list","at_list_len","at_user_len","splice","msgOutbox","textMsg","emitTextMsg","isMsgNotify","errMsg","okMsg","type","input_shake_animate","forgot","step","returnToPreviousStep","gotoStepThree","forgotEmailSubmit","email","forgotCodeSubmit","password","isLogin","toggleSubmit","login","register","loginSubmit","user","registerSubmit","lowercase","directive","restrict","link","scope","elem","attr","focus","attrs","getNowPos","bind","now_pos","viewedMsg","template","atMsg","isAtMsgShow","document","getElementById","classList","add","scrollToSpecPos","isViewMsg","chatBoxHeight","msgNotifyBox","inputElem","find","blur","toggleClass","isImageLoaded","loadScript","e","t","a","n","r","createElement","src","onload","onreadystatechange","this","readyState","getElementsByTagName","parentNode","insertBefore","replaceWith","Vivus","duration","animTimingFunction","EASE_OUT_BOUNCE","isImgBoxRight","now_zoom_id","imgURL","toggleImgBox","obj","equals","toggleImageSize","url","openLink","open","removeClass","addClass","value","userCount","count","service","distanceHelper","lat1","lon1","lat2","lon2","unit","radlat1","Math","PI","radlat2","theta","radtheta","dist","sin","cos","acos","weather_condition_codes","200","icon","201","202","210","211","212","221","230","231","232","300","301","302","310","311","313","314","321","500","501","502","503","504","511","520","521","522","531","600","601","602","611","612","615","616","620","621","622","701","711","721","731","741","751","761","771","781","800","801","802","803","804","900","901","902","903","904","905","906","951","952","953","954","955","956","957","958","959","960","961","962","origin","destination","sinaImgHelper","img_url","size","now","number","list_len","cache","small","medium","large","nowPos","clientHeight","storeNowPos","scrollTop","offsetTop","setNowPos","getBottomPos","chatBoxElem","scrollHeight","target_pos","element","scrollTo","then","hour","last","getTodayMs","UTC","getUTCFullYear","getUTCMonth","getUTCDate"],"mappings":"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","file":"sy.min.js","sourcesContent":["angular.module('ShinyaApp', [\n    'ngRoute',\n    'ngTouch',\n    'ngAnimate',\n    'angular-jwt',\n    'angular-storage',\n    'ShinyaApp.posHelperServices',\n    'ShinyaApp.timeHelperServices',\n    'ShinyaApp.geoHelperServices',\n    'ShinyaApp.msgHelperServices',\n    'ShinyaApp.notifyDirective',\n    'ShinyaApp.autofocusDirective',\n    'ShinyaApp.hideKeyboardDirective',\n    'ShinyaApp.imageonloadDirective',\n    'ShinyaApp.autoscrollDirective',\n    'ShinyaApp.imgDirective',\n    'ShinyaApp.beepDirective',\n    'ShinyaApp.usercountDirective',\n    'ShinyaApp.submitController',\n    'ShinyaApp.chatController',\n    'ShinyaApp.forgotController',\n    'duScroll'\n    ])\n.config(['$routeProvider', '$locationProvider', '$httpProvider', 'jwtInterceptorProvider', \n    function ($routeProvider, $locationProvider, $httpProvider, jwtInterceptorProvider) {\n    // $locationProvider.html5Mode(false).hashPrefix('!')\n    $locationProvider.html5Mode(true)\n    $routeProvider.\n        when('/', {\n            templateUrl: '/public/js/templates/submit.html',\n            controller: 'submitController'\n        }).\n        when('/chat', {\n            templateUrl: '/public/js/templates/chat.html',\n            controller: 'chatController'\n        }).\n        when('/forgot', {\n            templateUrl: '/public/js/templates/forgot.html',\n            controller: 'forgotController'\n        }).\n        otherwise({\n            redirectTo: '/'\n        })\n    jwtInterceptorProvider.tokenGetter = ['store', function(store) {\n        return store.get('id_token')\n    }]\n    $httpProvider.interceptors.push('jwtInterceptor')\n}])\n.controller('rootController', ['$rootScope', '$scope', '$timeout', '$location', '$route', '$window', 'jwtHelper', 'store', \n    function($rootScope, $scope, $timeout, $location, $route, $window, jwtHelper, store){\n\n    // 檢測是否為手機瀏覽器\n    // https://stackoverflow.com/questions/11381673/detecting-a-mobile-browser\n    function detectmob() { \n        var ua = $window.navigator.userAgent;\n        if(\n            ua.match(/Android/i)\n            || ua.match(/webOS/i)\n            || ua.match(/iPhone/i)\n            || ua.match(/iPad/i)\n            || ua.match(/iPod/i)\n            || ua.match(/BlackBerry/i)\n            || ua.match(/Windows Phone/i)\n        ){\n            return true;\n        }\n        else {\n            return false;\n        }\n    }\n    $rootScope.isMobile = detectmob()\n\n    // 檢測是否為全屏模式\n    if (!$window.navigator.standalone && $rootScope.isMobile){\n        console.log('no fullscreen mode')\n    }\n\n    /* 檢查 token\n     *  - 不存在\n     *  - 存在，腐爛：觸發提醒（submitController 處理）\n     *  - 存在，新鮮：跳轉到 '/chat'\n     */\n    // 必須 $routeChangeStart 攔截，否則若 token 過期，socket.io 握手不成功\n    $scope.$on('$routeChangeStart', function (event, current, pre, next){\n        if ($location.path() === '/'){\n            if (store.get('id_token')){\n                if (!jwtHelper.isTokenExpired(store.get('id_token'))){\n                    $location.path('/chat').replace()\n                }\n            }\n        } else if ($location.path() === '/chat'){\n            if(!store.get('id_token')){\n                $location.path('/').replace()\n            } else {\n                if (jwtHelper.isTokenExpired(store.get('id_token'))){\n                    $location.path('/').replace()\n                }\n            }\n        }\n    })\n    // 監聽開啟／關閉「位置服務」\n    $scope.$on('preTurnOnGeoServices', function (msg){\n        $timeout(function (){\n            $scope.$broadcast('turnOnGeoServices', msg)\n        }, 100)\n    })\n    $scope.$on('preTurnOffGeoServices', function (msg){\n        $timeout(function (){\n            $scope.$broadcast('turnOffGeoServices', msg)\n        }, 100)\n    })\n}])","angular.module('ShinyaApp.chatController', [])\n.controller('chatController', ['$rootScope', '$scope', '$http', '$timeout', '$window', '$location', '$filter', 'jwtHelper','store', 'syPosHelper', 'syTimeHelper', 'syGeoHelper', 'syMsgHelper', \n    function ($rootScope, $scope, $http, $timeout, $window, $location, $filter, jwtHelper, store, syPosHelper, syTimeHelper, syGeoHelper, syMsgHelper){\n\n    /*\n     **********\n     * 頁面切換\n     **********\n     *  `$scope.isChatBox`：是否處於 `chat_box` 頁面\n     *  `$scope.isSun`：提示標誌(白天／夜晚)\n     *  `$scope.toggleChatBox`：切換頁面\n     *      移動端：根據滑動切換\n     *          右滑：若處於 `chat_box`，切換到 `info_box`\n     *               若處於 `geo_box` / `news_box / `load_box`，切換到 `info_box`\n     *\n     *          左滑：若處於 `info_box`，切換到 `chat_box`\n     *\n     *      桌面段：根據點擊 `.sunAndMoon` 切換\n     *\n     */\n    $scope.isChatBox = true\n    if (syTimeHelper.getDaytimeOrNight(new Date().getHours()) === 'daytime'){\n        $scope.isSun = true        \n    } else {\n        $scope.isSun = false\n    }\n    $scope.isInfoBox = false\n    $scope.toggleChatBox = function (action){\n\n        if (!!action){\n            // 移動端\n            if (action === 'left'){\n                if ($scope.isChatBox){\n                    $scope.isChatBox = !$scope.isChatBox\n                }\n            } else if (action === 'right'){\n                if (!$scope.isChatBox && $scope.currentPage === 'infoBox'){\n                    $scope.isChatBox = !$scope.isChatBox\n                } else {\n                    $scope.toggleCurrentPage('infoBox')\n                }\n            }\n        } else {\n            // 桌面端\n            if (!$scope.isChatBox){\n                // 從 `geo_box` / `news_box` 返回 `chat_box` 時，重置 `user_info_box`\n                $scope.toggleCurrentPage('infoBox')\n            }\n            $scope.isChatBox = !$scope.isChatBox\n            $scope.isSun     = !$scope.isSun\n        }\n        $scope.now_img_list = []\n        $scope.isZoomIn = false\n    }\n    $scope.currentPage = 'infoBox'\n    $scope.toggleCurrentPage = function (name){\n        $timeout(function (){\n            $scope.currentPage = name\n        })\n    }\n    /*\n     **************\n     * 用戶基本信息\n     **************\n     *      `$scope.infoBox`\n     *          title: 加入於／當日天氣\n     *          username: 用戶名\n     *          numero: 註冊序號\n     *          date: 註冊日期\n     *          partsOfADay: 註冊當日時分\n     *          weather: 當日天氣\n     *\n     */\n    var token = store.get('id_token'),\n        decodeToken = jwtHelper.decodeToken(token);\n    console.log(decodeToken)\n    // 從 JWT 解碼獲取用戶信息\n    $scope.infoBox = {\n        title      : '加入於',\n        username   : decodeToken.username,\n        numero     : decodeToken.numero,\n        date       : $filter('date')(decodeToken.date, 'yyyy 年 M 月 d 日'),\n        partsOfADay: syTimeHelper.partsOfADay(~~($filter('date')(decodeToken.date, 'H'))),\n        weather    : decodeToken.weather.description\n    }\n    $scope.numero = syTimeHelper.getNumero($scope.infoBox.numero)\n    $scope.getDaytimeOrNight = syTimeHelper.getDaytimeOrNight(~~($filter('date')(decodeToken.date, 'H')))\n    $scope.partWeather = ''\n    $scope.togglePartWeather = function (){\n        if ($scope.partWeather == syGeoHelper.getCityWeatherType(decodeToken.weather.code)){\n            $scope.partWeather = ''\n            $timeout(function (){\n                $scope.infoBox.title = '加入於'\n            }, 777)\n        } else {\n            $scope.partWeather = syGeoHelper.getCityWeatherType(decodeToken.weather.code)\n            $timeout(function (){\n                $scope.infoBox.title = '當日天氣'\n            }, 777)\n        }\n    }\n    /*\n     *****************\n     * 用戶註冊當日新聞\n     *****************\n     *     `$scope.newsBox` 緩存獲取到的新聞\n     *     `$scope.selectDateNewsBox` 當前展示的新聞，從 `$scope.newsBox` 獲取\n     *     `$scope.selectDate` 本地時間\n     *     `$scope.previousHour` 獲取上一個時間段新聞\n     *          更新：`$scope.selectDate`、`$scope.selectDateNewsBox`\n     *     `$scope.nextHour` 獲取下一個時間段新聞\n     *          更新：`$scope.selectDate`、`$scope.selectDateNewsBox`\n     *     `getSelectedDateNews` 獲取新聞，\n     *         成功：保存到 `$scope.newsBox`，更新 `$scope.selectDateNewsBox`\n     *         失敗：\n     *             狀態碼 401：JWT 過期，跳轉到首頁\n     *             狀態碼 400：此時段新聞未獲取，`$scope.isNewsExist` -> false\n     */\n    $scope.isNewsExist = false\n    $scope.toggleNewsExist = function (){\n        $scope.isNewsExist = !$scope.isNewsExist\n    }\n    $scope.newsBox = {}\n    $scope.selectDateNewsBox = []\n    $scope.timezoneOffset = new Date().getTimezoneOffset() / 60\n    $scope.selectDate = new Date().getHours()\n    function getSelectedDateNews(callback){\n        $http.\n        post('/api/getSelectedDateNews', {\n            selectDate: $scope.selectDate,\n            timezoneOffset: $scope.timezoneOffset\n        }).\n        success(function (data, status, headers, config){\n            callback('ok', data.msg)\n        }).\n        error(function (data, status, headers, config){\n            if (status === 401){\n                $location.path('/').replace()\n            } else {\n                callback('error', data.msg)\n            }\n        })\n    }\n    $scope.getSelectedDateNews = function(){\n        if ($scope.selectDate in $scope.newsBox){\n            // 從 `$scope.newsBox` 獲取，不執行 `getSelectedDateNews`\n            $scope.selectDateNewsBox = $scope.newsBox[$scope.selectDate]\n            if ($scope.currentPage === 'infoBox'){\n                $scope.toggleCurrentPage('newsBox')\n            }\n            if (!$scope.isNewsExist){\n                $scope.toggleNewsExist()\n            }\n        } else {\n            // 過場動畫\n            $scope.toggleCurrentPage('loadBox')\n            getSelectedDateNews(function (status, news){\n                if (status === 'ok'){\n                    $scope.newsBox[$scope.selectDate] = news\n                    $scope.selectDateNewsBox = $scope.newsBox[$scope.selectDate]\n                    if ($scope.currentPage === 'loadBox'){\n                        $scope.toggleCurrentPage('newsBox')\n                    }\n                    if (!$scope.isNewsExist){\n                        $scope.toggleNewsExist()\n                    }\n                } else {\n                    if ($scope.currentPage === 'loadBox'){\n                        $scope.toggleCurrentPage('newsBox')\n                    }\n                    if ($scope.isNewsExist){\n                        $scope.toggleNewsExist()\n                    }\n                }\n            })\n        }\n    }\n    $scope.previousHour = function (){\n        if ($scope.selectDate > 1){\n            $scope.selectDate --\n            $scope.getSelectedDateNews()\n        } else {\n            $scope.selectDate = 24\n            $scope.getSelectedDateNews()\n        }\n    }\n    $scope.nextHour = function (){\n        if ($scope.selectDate < 24){\n            $scope.selectDate ++\n            $scope.getSelectedDateNews()\n        } else {\n            $scope.selectDate = 1\n            $scope.getSelectedDateNews()\n        }\n    }\n    /**********\n     * 設置界面\n     **********\n     *\n     *  `$scope.gotoSettingBox`：跳轉到「設置界面」\n     *  `$scope.quit`：註銷\n     *  `$scope.toggleGeoServices`：開關「位置服務」\n     *\n     */\n    $scope.gotoSettingBox = function (){\n        if ($scope.currentPage === 'infoBox'){\n            $scope.toggleCurrentPage('settingBox')\n        }\n     }\n    $scope.isMuted = !!store.get('isMuted')\n    $scope.toggleMuted = function (){\n        $scope.isMuted = !$scope.isMuted\n        store.set('isMuted', $scope.isMuted)\n    }\n    $scope.quit = function (){\n        store.remove('id_token')\n        store.remove('isGeoServices')\n        $rootScope.socket.disconnect()\n        $location.path('/')\n    }\n    $scope.isGeoServices = store.get('isGeoServices') || decodeToken.isGeoServices\n    $scope.toggleGeoServices = function (){\n        $http.\n        post('/api/toggleGeoServices', {\n            'isGeoServices': !$scope.isGeoServices\n        }).\n        success(function (data, status, headers, config){\n            if (data.msg === 'on'){\n                store.set('isGeoServices', true)\n                $scope.$emit('preTurnOnGeoServices', '驗證身份以開啟服務')\n            } else {\n                store.set('isGeoServices', false)\n                $scope.$emit('preTurnOffGeoServices', '驗證身份以關閉服務')\n            }\n            $scope.quit()\n        }).\n        error(function (data, status, headers, config){\n            if (status === 401){\n                $location.path('/')\n            }\n        })\n    }\n    /*\n     **************\n     * 地理位置相關\n     **************\n     * \n     * `$scope.geoBox`：地理位置信息\n     * `$scope.weatherBox`：天氣信息\n     * `$scope.isGeoServices`：是否已開啟「位置服務」\n     * `$scope.isSameDay`：判斷是否同一天\n     * `$scope.getGeoServices`：獲取位置信息\n     *\n     */\n    $scope.geoBox = {}\n    $scope.weatherBox = {}\n    $scope.isSameDay = false\n    $scope.getGeoServices = function (){\n        if (!$scope.isGeoServices){\n            // 未開啟「位置服務」\n            if ($scope.currentPage === 'infoBox'){\n                $scope.toggleCurrentPage('geoBox')\n            }\n        } else if ($scope.geoBox.distance) {\n            // 已開啟「位置服務」\n            // 已獲取「位置服務」所需信息，跳轉到 `geo_box`\n            if ($scope.currentPage === 'infoBox'){\n                $scope.toggleCurrentPage('geoBox')\n            }\n        } else {\n            // 未獲取「位置服務」所需信息，跳轉到「過場動畫」\n            if ($scope.currentPage === 'infoBox'){\n                $scope.toggleCurrentPage('loadBox')\n            }\n            $window.navigator.geolocation.getCurrentPosition(function (pos){\n                console.log(pos.coords.latitude, pos.coords.longitude)\n                $http.\n                post('/api/getGeoServices', {\n                    coords: {\n                        lat: pos.coords.latitude,\n                        lon: pos.coords.longitude\n                    }\n                }).\n                success(function (data, status, headers, config){\n\n                    var last_code    = data.msg.last_geo.weather.code,\n                        last_isNight = data.msg.last_geo.weather.isNight,\n                        now_code     = data.msg.now_geo.weather.code,\n                        now_isNight  = data.msg.now_geo.weather.isNight\n                        last_weather = syGeoHelper.getGeoWeatherType(last_code, last_isNight),\n                        now_weather  = syGeoHelper.getGeoWeatherType(now_code, now_isNight);\n\n                    $scope.geoBox = data.msg\n                    $scope.geoBox.distance = syGeoHelper.getDistance(data.msg.last_geo, data.msg.now_geo)\n                    $scope.weatherBox = {\n                        'last_weather': last_weather,\n                        'now_weather': now_weather\n                    }\n                    $scope.isSameDay = syTimeHelper.isSameDay($scope.geoBox.now_geo.date, $scope.geoBox.last_geo.date)\n                    if ($scope.currentPage === 'loadBox'){\n                        $scope.toggleCurrentPage('geoBox')\n                    }\n                }).\n                error(function (data, status, headers, config){\n                    if (status === 401){\n                        $location.path('/')\n                    }\n                })\n            })\n        }\n    }\n    /********\n     * @user\n     ********\n     *\n     *  `$scope.atUser`：當前 @ 的用戶列表\n     *  `$scope.isUserOnline`：判斷用戶是否在線\n     *\n     */\n    $scope.atUser = []\n    $scope.isUserOnline = function (username){\n        return $scope.onlineUser.indexOf(username.slice(1)) >= 0\n    }\n    $scope.$watch('msgOutbox.textMsg', function (newVal, oldVal){\n\n        var at_list = newVal.match(/\\@([^\\s\\@]){1,16}/g)\n        if (at_list && at_list !== $scope.atUser){\n            // 是否需要「新增」\n            var at_list_len = at_list.length\n            for (var i = 0; i < at_list_len; i ++){\n                if ($scope.atUser.indexOf(at_list[i]) < 0){\n                    $scope.atUser.push(at_list[i])\n                }\n            }\n            // 是否需要「刪減」\n            var at_user_len = $scope.atUser.length\n            for(var i = 0; i < at_user_len; i ++){\n                if (at_list.indexOf($scope.atUser[i]) < 0){\n                    $scope.atUser.splice(i, 1)\n                }\n            }\n        } else {\n            $scope.atUser = []\n        }\n    })\n    /*\n     *******************\n     * 文本消息抵達與發送\n     *******************\n     *  \n     *  `$scope.msgInbox`：存儲消息\n     *  `$scope.msgOutbox`：待發送消息\n     *  `onTextMsg`：文本消息抵達\n     *  `$scope.emitTextMsg`：文本消息發送\n     *\n     */\n    $scope.msgInbox = []\n    $scope.msgOutbox = {\n        'textMsg': ''\n    }\n    $scope.msgPosInfo = []\n    function onTextMsg(data) {\n        var isMe     = $rootScope.socket.id === data.id,\n            isBottom = syPosHelper.isBottom($scope.isScrollDown) || $scope.isScrollDown;\n        $scope.$apply(function (){\n            $scope.msgInbox.push({\n                'isMe'      : isMe,\n                'isImg'     : data.img_list.length > 0,\n                'isShowDate': syMsgHelper.isShowDate(data.date),\n                'date'      : data.date,\n                'msg'       : syMsgHelper.msgSanitization(data.msg, data.img_list),\n                'username'  : data.username,\n            })\n            if (data.img_list.length > 0){\n                $scope.img_list[data.date] = syMsgHelper.imgSanitization(data.img_list)\n            }\n        })\n        /* 新消息抵達時：\n         *      當用戶處於 chat_box 底部，滾動到底部\n         *      若不處於 chat_box，新消息提醒\n         *      當用戶回滾查看歷史消息時，新消息提醒\n         *      當用戶發送新消息時，滾動到底部\n         *\n         */\n        if ((isBottom || isMe) && $scope.isChatBox){\n            syPosHelper.scrollToPos()\n        } else if (data.at && data.at.indexOf('@' + decodeToken.username) >= 0){\n            $scope.msgNotify('atMsg', data.username, data.date)\n        } else if (!isMe && !$scope.contentItem){\n            $scope.msgNotify('newMsg', '新消息')\n        }\n        // 存儲消息頂部與底部位置\n        $scope.msgPosInfo.push({\n            'id': data.date,\n            'topPos': syPosHelper.getElemTopPos(data.date),\n            'bottomPos': syPosHelper.getElemBottomPos(data.date)\n        })\n    }\n    $scope.emitTextMsg = function (){\n\n        var at_list = $scope.msgOutbox.textMsg.match(/\\@([^\\s\\@]){1,16}/g)\n        // 屏蔽純空白輸入，由於 ngInput 默認 trim，故只需判斷是否為空，無需判斷空白字符\n        if ($scope.msgOutbox.textMsg !== ''){\n            $rootScope.socket.emit('textMsg', {\n                'id'      : $rootScope.socket.id,\n                'msg'     : $scope.msgOutbox.textMsg,\n                'username': $scope.infoBox.username,\n                'at'      : at_list\n            })\n            // 重置 `$scope.atUser` & `$scope.msgOutbox.textMsg`\n            $scope.atUser = ''\n            $scope.msgOutbox.textMsg = ''\n        }\n        $scope.isZoomIn = false\n    }\n    /*\n     **************\n     * Socket.IO\n     **************\n     */\n    function connectSIO(){\n        $rootScope.socket = io(':8080', {\n            'query': 'token=' + token\n            // 'secure': true\n        })\n        $rootScope.socket.on('connect', function (){\n            // 獲取最近的十條消息\n            $rootScope.socket.emit('latestMsg', $scope.msgInbox.length >= 0)\n            $rootScope.socket.on('latestMsg', function (data){\n                var data_len = data.length\n                for (var i = 0; i < data_len; i++){\n                    $scope.$apply(function (){\n                        $scope.msgInbox.push({\n                            'isMe'      : decodeToken.username === data[i].username,\n                            'isImg'     : data[i].img_list.length > 0,\n                            'isShowDate': (i === 0) ? true : false,\n                            'date'      : data[i].date,\n                            'msg'       : syMsgHelper.msgSanitization(data[i].msg, data[i].img_list),\n                            'username'  : data[i].username\n                        })\n                        if (data[i].img_list.length > 0){\n                            $scope.img_list[data[i].date] = syMsgHelper.imgSanitization(data[i].img_list)\n                        }\n                    })\n                    // 存儲消息頂部與底部位置\n                    $scope.msgPosInfo.push({\n                        'id': data[i].date,\n                        'topPos': syPosHelper.getElemTopPos(data[i].date),\n                        'bottomPos': syPosHelper.getElemBottomPos(data[i].date)\n                    })\n                }\n            })\n        })\n        /* 新文本消息抵達 */\n        $rootScope.socket.on('textMsg', function (msg){\n            onTextMsg(msg)\n        })\n         /* 有用戶加入 */\n        $rootScope.socket.on('userJoin', function (msg){\n            $scope.onUserIO(msg)\n        })\n         /* 有用戶退出 */\n        $rootScope.socket.on('disconnect', function (msg){\n            $scope.onUserIO(msg)\n        })\n    }\n    function reconnectSIO(){\n        console.log('reconnect')\n        $rootScope.socket.disconnect()\n        $rootScope.socket.connect(':8080')\n        $rootScope.socket.on('textMsg', function (msg){\n            onTextMsg(msg)\n        })\n    }\n    if (!$rootScope.socket){\n        connectSIO()\n    } else {\n        reconnectSIO()\n    }\n\n}])","angular.module('ShinyaApp.forgotController', [])\n.controller('forgotController', ['$scope', '$http', '$timeout', '$location', function($scope, $http, $timeout, $location){\n    /*\n     **********\n     * 消息提醒\n     **********\n     *\n     *  `$scope.isMsgNotify`：是否為消息提醒\n     *  `$scope.errMsg`：錯誤消息\n     *  `$scope.okMsg`：成功消息\n     *  `$scope.msgNotify`：觸發消息提醒\n     *\n     */\n    $scope.isMsgNotify = false\n    $scope.errMsg = ''\n    $scope.okMsg = ''\n    $scope.msgNotify = function (type, data){\n        if (type === 'error'){\n            $scope.input_shake_animate = true\n            $scope.errMsg = data.msg\n            $scope.isMsgNotify = true\n            $timeout(function (){\n                $scope.errMsg = ''\n                $scope.input_shake_animate = false\n                $scope.isMsgNotify = false\n            }, 1717)\n        } else if (type === 'ok'){\n            $scope.okMsg = data.msg\n            $scope.isMsgNotify = true\n            $timeout(function (){\n                $scope.okMsg = ''\n                $scope.isMsgNotify = false\n            }, 1717)\n        } else {\n            console.error('[TypeError]: Not `error` or `ok`')\n        }\n    }\n    /*\n     **********\n     * 忘記密碼\n     **********\n     *  `$scope.forgot`：存儲用戶需提交的信息\n     *  `$scope.step`：當前處於第幾步\n     *  `$scope.returnToPreviousStep`：返回上一步\n     *  `$scope.gotoStepThree`：跳轉到第三步\n     *  `$scope.forgotEmailSubmit`：提交「電郵地址」\n     *  `$scope.forgotCodeSubmit`：提交「驗證碼」和「新密碼」\n     */\n    $scope.forgot = {}\n    $scope.step = 1\n    $scope.returnToPreviousStep = function (){\n        if ($scope.step === 1){\n            $location.path('/')\n        } else {\n            $scope.step = $scope.step - 1\n        }\n    }\n    $scope.gotoStepThree = function (){\n        $scope.step = 3\n        $scope.msgNotify('ok', {'msg': '請輸入新密碼'})\n    }\n    $scope.forgotEmailSubmit = function (){\n\n        $http.\n        post('/forgot_email', {\n            \"email\": $scope.forgot.email\n        }).\n        success(function (data, status, headers, config){\n            $scope.step = 2\n            $scope.msgNotify('ok', data)\n        }).\n        error(function (data, status, headers, config){\n            $scope.msgNotify('error', data)\n        })\n        $scope.forgot = {}\n    }\n    $scope.forgotCodeSubmit = function (){\n\n        $http.\n        post('/forgot_code', {\n            'code': $scope.forgot.code,\n            'password': $scope.forgot.password\n        }).\n        success(function (data, status, headers, config){\n            $scope.msgNotify('ok', data)\n            $timeout(function (){\n                $location.path('/')\n            }, 2000)\n        }).\n        error(function (data, status, headers, config){\n            $scope.msgNotify('error', data)\n        })\n        $scope.forgot = {}\n    }\n}])","angular.module('ShinyaApp.submitController', [])\n.controller('submitController', ['$scope', '$http', '$timeout', '$location', '$route', '$window', 'jwtHelper', 'store',\n    function ($scope, $http, $timeout, $location, $route, $window, jwtHelper, store){\n\n    /*\n     **********\n     * 消息提醒\n     **********\n     *\n     *  `$scope.isMsgNotify`：是否為消息提醒\n     *  `$scope.errMsg`：錯誤消息\n     *  `$scope.okMsg`：成功消息\n     *  `$scope.msgNotify`：觸發消息提醒\n     *\n     */\n    $scope.isMsgNotify = false\n    $scope.errMsg = ''\n    $scope.okMsg = ''\n    $scope.msgNotify = function (type, data){\n        if (type === 'error'){\n            $scope.input_shake_animate = true\n            $scope.errMsg = data.msg\n            $scope.isMsgNotify = true\n            $timeout(function (){\n                $scope.errMsg = ''\n                $scope.input_shake_animate = false\n                $scope.isMsgNotify = false\n            }, 1717)\n        } else if (type === 'ok'){\n            $scope.okMsg = data.msg\n            $scope.isMsgNotify = true\n            $timeout(function (){\n                $scope.okMsg = ''\n                $scope.isMsgNotify = false\n            }, 1717)\n        } else {\n            console.error('[TypeError]: Not `error` or `ok`')\n        }\n    }\n    /*\n     **********\n     * 驗證相關\n     **********\n     */\n    // token 腐爛，觸發提醒\n    if (!!store.get('id_token')){\n        if (jwtHelper.isTokenExpired(store.get('id_token'))){\n            // 此時 $scope.msgNotify 方法還沒定義\n            $timeout(function (){\n                $scope.msgNotify('ok', {'msg': '請重新登錄'})\n            }, 0)\n        }\n    }\n    // 監聽開啟／關閉「位置服務」\n    $scope.$on('turnOnGeoServices', function (msg){\n        $timeout(function (){\n            $scope.msgNotify('ok', {'msg': '驗證身份以開啟服務'})\n        }, 0)\n    })\n    $scope.$on('turnOffGeoServices', function (msg){\n        $timeout(function (){\n            $scope.msgNotify('ok', {'msg': '驗證身份以取消服務'})\n        }, 0)\n    })\n\n    /*\n     **********\n     * 頁面切換\n     **********\n     */\n    $scope.isLogin = true;\n    $scope.toggleSubmit = function (){\n        $scope.isLogin = !$scope.isLogin\n    }\n    /*\n     ************\n     * 登陸／註冊\n     ************\n     *\n     *  `$scope.login`：緩存登陸信息\n     *  `$scope.register`：緩存註冊信息\n     *  `$scope.loginSubmit`：處理登陸\n     *  `$scope.registerSubmit`：處理註冊\n     *\n     */\n    $scope.login = {}\n    $scope.register = {}\n    $scope.loginSubmit = function (){\n\n        $http.\n        post('/login', {\n            \"user\": $scope.login.user,\n            \"password\": $scope.login.password\n        }).\n        success(function (data, status, headers, config){\n            store.set('id_token', data.token)\n            $location.path('/chat').replace()\n        }).\n        error(function (data, status, headers, config){\n            $scope.msgNotify('error', data)\n        })\n        $scope.login = {}\n    }\n    $scope.registerSubmit = function (){\n        $http.\n        post('/register', {\n            \"username\": $scope.register.username,\n            \"email\": angular.lowercase($scope.register.email), \n            \"password\": $scope.register.password\n        }).\n        success(function (data, status, headers, config){\n            $scope.msgNotify('ok', data)\n            // switch to [login]\n            $scope.toggleSubmit()\n        }).\n        error(function (data, status, headers, config){\n            $scope.msgNotify('error', data)\n        })\n        $scope.register = {}\n    }\n}])\n","angular.module('ShinyaApp.autofocusDirective', [])\n.directive('syAutofocus', ['$rootScope', '$timeout', function ($rootScope, $timeout){\n    return {\n        restrict: 'A',\n        link: function (scope, elem, attr){\n            if (!$rootScope.isMobile){\n                $timeout(function (){\n                    elem[0].focus()\n                })\n            }\n        }\n    }\n}])","angular.module('ShinyaApp.autoscrollDirective' ,[])\n.directive('syAutoscroll', ['syPosHelper', function (syPosHelper){\n    return {\n        restrict: 'A',\n        link: function (scope, elem, attrs){\n            var pos = syPosHelper.getNowPos()\n            elem.bind('scroll', function (){\n                var now_pos = syPosHelper.getNowPos()\n                if (now_pos >= pos && syPosHelper.getNowPos() > 0){\n                    // Scroll Down\n                    scope.isScrollDown = true\n                } else {\n                    // Scroll Up\n                    scope.isScrollDown = false\n                }\n                pos = now_pos\n                if (syPosHelper.isBottom(scope.isScrollDown)){\n                    scope.$apply(function (){\n                        scope.viewedMsg(2)\n                    })\n                }\n            })\n        }\n    }\n}])","angular.module('ShinyaApp.beepDirective', [])\n.directive('syBeep', ['$timeout', 'syPosHelper', function ($timeout, syPosHelper){\n    return {\n        restrict: 'E',\n        replace : true,\n        template: '<div class=\"all_notify_box general_animate\" ng-if=\"!isViewMsg\" id=\"notify_box\">'\n                +   '<span ng-click=\"viewedMsg(1)\">{{msgNotifyBox.msg}}</span>'\n                +   '<audio ng-if=\"!isMuted\" autoplay>'\n                +       '<source src=\"public/sound/beep.ogg\" type=\"audio/ogg\">'\n                +       '<source src=\"public/sound/beep.m4a\" type=\"audio/x-m4a\">'\n                +   '</audio>'\n                +   '<audio ng-if=\"isMuted\" autoplay muted>'\n                +       '<source src=\"public/sound/beep.ogg\" type=\"audio/ogg\">'\n                +       '<source src=\"public/sound/beep.m4a\" type=\"audio/x-m4a\">'\n                +   '</audio>'\n                + '</div>',\n        controller: ['$scope', function ($scope){\n            /*\n             * 新消息抵達提醒\n             *      `$scope.isViewMsg`：新消息是否已閱\n             *      `$scope.msgNotifyBox`：提醒消息的內容\n             *      `$scope.isAtMsg`：判斷是否為提到（@）你的信息\n             *      `$scope.contentItem`：存儲提到（@）你的消息 id\n             */\n            $scope.isViewMsg = true\n            $scope.msgNotifyBox = {}\n            $scope.contentItem = 0\n            /* 滾動到消息位置後改變消息樣式 */\n            $scope.isAtMsgShow = false\n            function atMsg(id){\n                $scope.isAtMsgShow = true\n                var elem = document.getElementById(id)\n                elem.classList.add('atMsg')\n                $timeout(function (){\n                    elem.classList.remove('atMsg')\n                    $timeout(function (){\n                        $scope.isAtMsgShow = false\n                    }, 717)\n                }, 717)\n            }\n            function scrollToSpecPos(){\n                $scope.isViewMsg = true\n                if ($scope.contentItem){\n                    // 有用戶提到（@）你，滾動到相應位置\n                    var pos = syPosHelper.getElemTopPos($scope.contentItem) - syPosHelper.chatBoxHeight / 2\n                    syPosHelper.scrollToPos(pos || null, $scope.isScrollDown)\n                    atMsg($scope.contentItem)\n                    $scope.contentItem = 0\n                } else {\n                    // 新消息，滾動到底部\n                    syPosHelper.scrollToPos(null, $scope.isScrollDown)\n                }   \n            }\n            $scope.viewedMsg = function (type){\n                // 當前不處於 chat_box，切換到 chat_box 後滾動\n                if (!$scope.isChatBox){\n                    if (!$scope.isChatBox){\n                        // 從 `geo_box` / `news_box` 返回 `chat_box` 時，重置 `user_info_box`\n                        $scope.toggleCurrentPage('infoBox')\n                    }\n                    $scope.isChatBox = !$scope.isChatBox\n                    $timeout(function (){\n                        scrollToSpecPos()\n                    })\n                } else {\n                    if (type === 1){\n                        $scope.isZoomIn = false\n                        // 滾動並抹除提醒\n                        scrollToSpecPos()\n                    } else if (type === 2){\n                        // 不滾動，只抹除提醒\n                        $scope.isViewMsg = true\n                    }\n                }\n\n            }\n            $scope.msgNotify = function(type, msg, pos){\n                $scope.$apply(function (){\n                    if (type === 'newMsg'){\n                        $scope.msgNotifyBox = {\n                            'type': 'newMsg',\n                            'msg' : msg\n                        }\n                        $scope.isViewMsg = false\n                    } else if (type === 'atMsg'){\n                        $scope.msgNotifyBox = {\n                            'type': 'atMsg',\n                            'msg' : '@' + msg + ' 提到了你'\n                        }\n                        $scope.contentItem = pos\n                        $scope.isViewMsg = false\n                    }\n                })\n            }\n        }]\n    }\n}])","angular.module('ShinyaApp.hideKeyboardDirective', [])\n.directive('syHideKeyboard', ['$rootScope', function ($rootScope){\n    return {\n        restrict: 'A',\n        link: function (scope, elem, attr){\n            var inputElem = elem.find('input');\n            if ($rootScope.isMobile){\n                elem.bind('submit', function (){\n                    inputElem[0].blur()\n                })\n            }\n        }\n    }\n}])","// via http://stackoverflow.com/a/17884754/3786947\nangular.module('ShinyaApp.imageonloadDirective', [])\n.directive('syImageonload', ['$rootScope', '$timeout', function ($rootScope, $timeout){\n    return {\n        restrict: 'A',\n        link: function(scope, elem, attr) {\n            elem.toggleClass('loding')\n            elem.bind('load', function() {\n                elem.toggleClass('loding')\n                scope.$apply(function (){\n                    scope.isImageLoaded = true\n                })\n            })\n            elem.bind('error', function (){\n                if (elem.attr('ng-class') === '{\\'zoom_out\\': isZoomIn && $index === now_zoom_id}'){\n                    // #img_box\n                    elem.attr('src', 'data:image/jpg;base64,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')\n                } else {\n                    // #img_fullscreen_box\n                    // via http://stackoverflow.com/a/7719185/3786947\n                    function loadScript(e,t){var a,n,r;n=!1,a=document.createElement(\"script\"),a.type=\"text/javascript\",a.src=e,a.onload=a.onreadystatechange=function(){n||this.readyState&&\"complete\"!=this.readyState||(n=!0,t())},r=document.getElementsByTagName(\"script\")[0],r.parentNode.insertBefore(a,r)}\n                    loadScript('/public/dist/vivus.min.js', function (){\n                        elem.next().remove()\n                        elem.replaceWith('<svg id=\"vivus_img_load_err\" width=\"200\" height=\"200\" viewBox=\"0 0 530 531\" xmlns=\"http://www.w3.org/2000/svg\"><g fill=\"none\"><path d=\"M51.249 150.754c-3.454-1.73-5.458-.099-4.478 3.638l.706 2.688c8.007 30.503-2.998 73.868-24.584 96.861l-.662.706c-2.644 2.816-1.65 5.288 2.192 5.521l136.651 8.259c9.377.567 23.956-2.028 32.559-5.794l21.283-9.316-13.767-18.806c-5.549-7.58-16.85-17.132-25.253-21.34l-124.647-62.418z\" fill=\"#000\"/><path d=\"M9.298 290.938c13.001 129.203 122.073 230.062 254.702 230.062 141.385 0 256-114.615 256-256s-114.615-256-256-256c-84.794 0-159.96 41.226-206.547 104.728\" stroke=\"#000\" stroke-width=\"17\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/><path d=\"M361.259 190.733c-4.06-1.129-8.339-1.733-12.759-1.733-26.234 0-47.5 21.266-47.5 47.5 0 4.115.523 8.109 1.507 11.917\" stroke=\"#000\" stroke-width=\"17\" stroke-linecap=\"round\"/><path d=\"M213.468 406.97c13.141-16.776 37.347-28.026 65.032-28.026 30.37 0 56.552 13.538 68.536 33.056\" stroke=\"#000\" stroke-width=\"17\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/></g></svg>')\n                        new Vivus('vivus_img_load_err', {type: 'delayed', duration: 77, animTimingFunction: Vivus.EASE_OUT_BOUNCE})\n                        scope.$apply(function (){\n                            scope.isImageLoaded = true\n                        })\n                    })\n                }\n            })\n        }\n    }\n}])","angular.module('ShinyaApp.imgDirective', [])\n.directive('syImg', function (){\n    return {\n        restrict: 'E',\n        replace : true,\n        template: '<div ng-if=\"now_img_list.length > 0\" id=\"img_box\" ng-class=\"{\\'me\\': isImgBoxRight, \\'mobile\\': isMobile}\">'\n                +   '<ul>'\n                +       '<li ng-repeat=\"url in now_img_list\" class=\"general_animate\">'\n                +           '<img ng-src=\"{{url.small}}\" ng-class=\"{\\'zoom_out\\': isZoomIn && $index === now_zoom_id}\" ng-click=\"toggleImageSize(url, $index)\" sy-imageonload>'\n                +       '</li>'\n                +   '</ul>'\n                + '</div>',\n        controller: ['$scope', '$window', '$timeout', function ($scope, $window, $timeout){\n            /*\n             **************\n             * 圖片消息相關\n             **************\n             * \n             *  `$scope.isZoomIn`：圖片是否放大\n             *  `$scope.isImgBoxRight`：`img_box` 是否右浮\n             *  `$scope.isImageLoaded`：大圖是否已經加載完畢\n             *  `$scope.img_list`：存儲消息中所有的圖片消息\n             *  `$scope.now_img_list`：現在閱覽中的消息中中的圖片\n             *  `$scope.now_zoom_id`：現在閱覽中的圖片的 $index\n             *  `$scope.imgURL`：現在閱覽中的大圖的 URL\n             *  `$scope.toggleImgBox`：處理顯示／隱藏 `img_box`\n             *  `$scope.toggleImageSize`：處理打開／關閉大圖\n             *\n             */\n            $scope.isZoomIn = false\n            $scope.isImgBoxRight = false\n            $scope.isImageLoaded = false\n            $scope.img_list = {}\n            $scope.now_img_list = []\n            $scope.now_zoom_id = -1\n            $scope.imgURL = ''\n            $scope.toggleImgBox = function (obj){\n                var isMe = obj.isMe,\n                    id   = obj.date;\n                if ($scope.now_img_list !== $scope.img_list[id] && angular.equals($scope.now_img_list, [])){\n                    // 現在不存在已打開的圖片預覽，直接打開\n                    $scope.isImgBoxRight = isMe\n                    $scope.now_img_list = $scope.img_list[id]\n                } else if ($scope.now_img_list !== $scope.img_list[id] && !angular.equals($scope.now_img_list, [])){\n                    // 現在存在已打開的圖片預覽，先關閉，再打開\n                    $scope.now_img_list = []\n                    $timeout(function (){\n                        $scope.isImgBoxRight = isMe\n                        $scope.now_img_list = $scope.img_list[id]\n                    }, 717)\n                } else {\n                    // 關閉圖片預覽\n                    $scope.now_img_list = []\n                }\n            }\n            $scope.toggleImageSize = function (url, id){\n                if (url && id !== $scope.now_zoom_id){\n                    // 切換大圖時，先 DOM 移除元素，再重新 DOM 插入元素\n                    // 使 `syImageonload` Directive 重載\n                    $scope.isZoomIn = false\n                    $timeout(function (){\n                        $scope.isZoomIn = true\n                    })\n                    $scope.imgURL = url\n                    $scope.now_zoom_id = id\n                    $scope.isImageLoaded = false\n                } else {\n                    $scope.isZoomIn = false\n                    $scope.now_zoom_id = -1\n                }\n            }\n            $scope.openLink = function (link){\n                $window.open(link)\n            }\n        }]\n    }\n})","angular.module('ShinyaApp.notifyDirective', [])\n.directive('syNotify', function (){\n    return {\n        restrict: 'A',\n        link: function (scope, elem, attr){\n            scope.$watch('isMsgNotify', function (newVal){\n                elem.removeClass('submit_animate')\n                elem.attr('type', 'button')\n                if (newVal){\n                    // elem.removeAttr('type')\n                    if (scope.errMsg){\n                        elem.addClass('error_msg')\n                        elem.attr('value', scope.errMsg)\n                    } else if (scope.okMsg){\n                        elem.addClass('ok_msg')\n                        elem.attr('value', scope.okMsg)\n                    } else {\n                        console.error('[TypeError]: Not `error` or `ok`')\n                    }\n                } else {\n                    elem.removeClass('error_msg ok_msg').addClass('submit_animate')\n                    elem.attr({\n                        'type' : 'submit',\n                        'value': '提交'\n                    })\n                }\n            })\n        }\n    }\n})","angular.module('ShinyaApp.usercountDirective', [])\n.directive('syUsercount', function (){\n    return {\n        restrict: 'E',\n        template: '<div ng-if=\"!isMobile\" id=\"userCount\">'\n                +   '在線人數：{{userCount}}'\n                + '</div>',\n        controller: ['$scope', function ($scope){\n            \n            // 在線人數\n            $scope.userCount  = 0\n            $scope.onlineUser = []\n            $scope.onUserIO = function(msg){\n                $scope.$apply(function (){\n                    $scope.userCount  = msg.count\n                    $scope.onlineUser = msg.onlineUser\n                })\n            }\n        }]\n    }\n})","angular.module('ShinyaApp.geoHelperServices', [])\n.service('syGeoHelper', function(){\n//:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::\n//:::                                                                         :::\n//:::  This routine calculates the distance between two points (given the     :::\n//:::  latitude/longitude of those points). It is being used to calculate     :::\n//:::  the distance between two locations using GeoDataSource (TM) prodducts  :::\n//:::                                                                         :::\n//:::  Definitions:                                                           :::\n//:::    South latitudes are negative, east longitudes are positive           :::\n//:::                                                                         :::\n//:::  Passed to function:                                                    :::\n//:::    lat1, lon1 = Latitude and Longitude of point 1 (in decimal degrees)  :::\n//:::    lat2, lon2 = Latitude and Longitude of point 2 (in decimal degrees)  :::\n//:::    unit = the unit you desire for results                               :::\n//:::           where: 'M' is statute miles (default)                         :::\n//:::                  'K' is kilometers                                      :::\n//:::                  'N' is nautical miles                                  :::\n//:::                                                                         :::\n//:::  Worldwide cities and other features databases with latitude longitude  :::\n//:::  are available at http://www.geodatasource.com                          :::\n//:::                                                                         :::\n//:::  For enquiries, please contact sales@geodatasource.com                  :::\n//:::                                                                         :::\n//:::  Official Web site: http://www.geodatasource.com                        :::\n//:::                                                                         :::\n//:::               GeoDataSource.com (C) All Rights Reserved 2015            :::\n//:::                                                                         :::\n//:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::\n\n    function distanceHelper(lat1, lon1, lat2, lon2, unit) {\n        var radlat1 = Math.PI * lat1/180\n        var radlat2 = Math.PI * lat2/180\n        var radlon1 = Math.PI * lon1/180\n        var radlon2 = Math.PI * lon2/180\n        var theta = lon1-lon2\n        var radtheta = Math.PI * theta/180\n        var dist = Math.sin(radlat1) * Math.sin(radlat2) + Math.cos(radlat1) * Math.cos(radlat2) * Math.cos(radtheta);\n        dist = Math.acos(dist)\n        dist = dist * 180/Math.PI\n        dist = dist * 60 * 1.1515\n        if (unit==\"K\") { dist = dist * 1.609344 }\n        if (unit==\"N\") { dist = dist * 0.8684 }\n        return dist\n    }\n    var weather_condition_codes = {\n        // http://openweathermap.org/weather-conditions\n        // Thunderstorm 200 ~ 232\n        '200': {'type': 'lightning', 'icon': 'lightning'},\n        '201': {'type': 'lightning', 'icon': 'lightning'},\n        '202': {'type': 'lightning', 'icon': 'lightning'},\n        '210': {'type': 'lightning', 'icon': 'lightning'},\n        '211': {'type': 'lightning', 'icon': 'lightning'},\n        '212': {'type': 'lightning', 'icon': 'lightning'},\n        '221': {'type': 'lightning', 'icon': 'lightning'},\n        '230': {'type': 'lightning', 'icon': 'lightning'},\n        '231': {'type': 'lightning', 'icon': 'lightning'},\n        '232': {'type': 'lightning', 'icon': 'lightning'},\n        // Drizzle 300 ~ 321\n        '300': {'type': 'rain', 'icon': 'drizzle'},\n        '301': {'type': 'rain', 'icon': 'drizzle'},\n        '302': {'type': 'rain', 'icon': 'drizzle'},\n        '310': {'type': 'rain', 'icon': 'drizzle'},\n        '311': {'type': 'rain', 'icon': 'drizzle'},\n        '313': {'type': 'rain', 'icon': 'showers'},\n        '314': {'type': 'rain', 'icon': 'showers'},\n        '321': {'type': 'rain', 'icon': 'showers'},\n        // Rain 500 ~ 531\n        '500': {'type': 'rain', 'icon': 'rain'},\n        '501': {'type': 'rain', 'icon': 'rain'},\n        '502': {'type': 'rain', 'icon': 'downpour'},\n        '503': {'type': 'rain', 'icon': 'downpour'},\n        '504': {'type': 'rain', 'icon': 'downpour'},\n        '511': {'type': 'rain', 'icon': 'flurries'},\n        '520': {'type': 'rain', 'icon': 'showers'},\n        '521': {'type': 'rain', 'icon': 'showers'},\n        '522': {'type': 'rain', 'icon': 'showers'},\n        '531': {'type': 'rain', 'icon': 'showers'},\n        // Snow 600 ~ 622\n        '600': {'type': 'snow', 'icon': 'snow'},\n        '601': {'type': 'snow', 'icon': 'snow'},\n        '602': {'type': 'snow', 'icon': 'snow'},\n        '611': {'type': 'snow', 'icon': 'sleet'},\n        '612': {'type': 'snow', 'icon': 'sleet'},\n        '615': {'type': 'snow', 'icon': 'sleet'},\n        '616': {'type': 'snow', 'icon': 'sleet'},\n        '620': {'type': 'snow', 'icon': 'sleet'},\n        '621': {'type': 'snow', 'icon': 'sleet'},\n        '622': {'type': 'snow', 'icon': 'sleet'},\n        // Atmosphere 701 ~ 781\n        '701': {'type': 'fog', 'icon': 'fog'},\n        '711': {'type': 'fog', 'icon': 'haze'},\n        '721': {'type': 'fog', 'icon': 'haze'},\n        '731': {'type': 'fog', 'icon': 'haze'},\n        '741': {'type': 'fog', 'icon': 'fog'},\n        '751': {'type': 'fog', 'icon': 'fog'},\n        '761': {'type': 'fog', 'icon': 'fog'},\n        '771': {'type': 'fog', 'icon': 'tornado'},\n        '781': {'type': 'fog', 'icon': 'tornado'},\n        // Sun & Clouds 800, 904\n        '800': {'type': 'sun', 'icon': 'sun'},\n        '801': {'type': 'sun', 'icon': 'sun'},\n        '802': {'type': 'clouds', 'icon': 'cloud'},\n        '803': {'type': 'clouds', 'icon': 'cloud'},\n        '804': {'type': 'clouds', 'icon': 'cloud'},\n        // Extreme\n        '900': {'type': 'wind', 'icon': 'tornado'},\n        '901': {'type': 'wind', 'icon': 'tornado'},\n        '902': {'type': 'wind', 'icon': 'tornado'},\n        '903': {'type': 'wind', 'icon': 'thermometer low'},\n        '904': {'type': 'wind', 'icon': 'thermometer full'},\n        '905': {'type': 'wind', 'icon': 'wind'},\n        '906': {'type': 'wind', 'icon': 'hail'},\n        // Additional\n        '951': {'type': 'wind', 'icon': 'wind'},\n        '952': {'type': 'wind', 'icon': 'wind'},\n        '953': {'type': 'wind', 'icon': 'wind'},\n        '954': {'type': 'wind', 'icon': 'wind'},\n        '955': {'type': 'wind', 'icon': 'wind'},\n        '956': {'type': 'wind', 'icon': 'tornado'},\n        '957': {'type': 'wind', 'icon': 'tornado'},\n        '958': {'type': 'wind', 'icon': 'tornado'},\n        '959': {'type': 'wind', 'icon': 'tornado'},\n        '960': {'type': 'wind', 'icon': 'tornado'},\n        '961': {'type': 'wind', 'icon': 'tornado'},\n        '962': {'type': 'wind', 'icon': 'tornado'}\n    }\n    this.getCityWeatherType = function (code){\n\n        if (code in weather_condition_codes){\n            return weather_condition_codes[code]['type']\n        } else {\n            return 'others'\n        }\n    },\n    this.getGeoWeatherType = function (code, isNight){\n\n        if (code in weather_condition_codes){\n            if (isNight){\n                return weather_condition_codes[code]['icon'] + ' moon'\n            } else {\n                return weather_condition_codes[code]['icon'] + ' sun'\n            }\n        } else {\n            return 'cloud refresh'\n        }\n    },\n    this.getDistance = function (origin, destination){\n\n        var distance = ~~distanceHelper(origin.lat, origin.lon, destination.lat, destination.lon, 'K')\n        return !!distance ? distance + ' km' : '0 km'\n    }\n})","angular.module('ShinyaApp.msgHelperServices', [])\n.service('syMsgHelper', function(){\n\n    function sinaImgHelper (img_url, size){\n        return img_url.replace(/square|thumbnail|thumb150|bmiddle|mw600|large/, size)\n    }\n    var now = Date.now()\n    // 間隔 60 秒顯示時間\n    this.isShowDate = function (date){\n        if (date - now > 1000 * 60){\n            now = Date.now()\n            return true\n        } else {\n            return false\n        }\n    },\n    // 將文本消息中包含的圖片超鏈接替換\n    this.msgSanitization = function (msg, img_list){\n        var number   = [\n        // 因限制了 1024 個字符，故圖片數目一般不超過以下列表的數字\n                '一', '二', '三', '四', '五', '六', '七', '八', '九', '十', \n                '十一', '十二', '十三', '十四', '十五', '十六', '十七', '十八', '十九', '廿', \n                '廿一', '廿二', '廿三', '廿四', '廿五', '廿六', '廿七', '廿八', '廿九', '卅', \n                '卅一', '卅二', '卅三', '卅四', '卅五', '卅六', '卅七', '卅八', '卅九' \n            ],\n            list_len = img_list.length;\n        for (var i = 0; i < list_len; i++){\n            msg = msg.replace(img_list[i], '[圖' + (number[i] ? number[i] : ' ' + (i + 1)) + ']')\n        }\n        return msg\n    },\n    // 將圖片超鏈接提取出「縮略圖」、「中圖」、「大圖」，目前僅支持新浪圖庫\n    this.imgSanitization = function (img_list){\n        var cache    = [],\n            list_len = img_list.length;\n        for (var i = 0; i < list_len; i++){\n            if (img_list.indexOf('sinaimg.cn' > 0)){\n                // 新浪圖床\n                cache.push({\n                    'small' : sinaImgHelper(img_list[i], 'square'),\n                    'medium': sinaImgHelper(img_list[i], 'bmiddle'),\n                    'large' : sinaImgHelper(img_list[i], 'large')\n                })\n            } else {\n                cache.push({\n                    'small' : img_list[i],\n                    'medium': img_list[i],\n                    'large' : img_list[i]\n                })\n            }\n        }\n        return cache\n    }\n})","angular.module('ShinyaApp.posHelperServices', [])\n.service('syPosHelper', ['$rootScope', function($rootScope){\n    \n    /*\n     * `this.nowPos`: 當前 `#chat_box` 位置\n     * `this.getBottomPos`: 獲取 `#chat_box` 底部位置\n     * `this.storeNowPos`: 保存 `#chat_box` 當前位置\n     * `this.setNowPos`: 設置 `#chat_box` 當前位置\n     * `this.getBottomPos`: 獲取 `#chat_box` 底部位置\n     * `this.isBottom`: 判斷是否在 `#chat_box` 底部\n     * `this.scrollToBottom`: 滾動到 `#chat_box` 底部\n     *\n     * `isScrolling` 是否正在滾動\n     *      是：若新消息抵達，滾動到底部\n     *      否：根據是否在底部和是否本人發送新消息，判斷是否需要滾動到底部\n     */\n    this.nowPos = 0\n    this.chatBoxHeight = document.getElementById('chat_box').clientHeight\n    this.storeNowPos = function (){\n        this.nowPos = document.getElementById('chat_box').scrollTop\n    }\n    this.getNowPos = function (){\n        return document.getElementById('chat_box').scrollTop\n    }\n    this.getElemTopPos = function (id){\n        return document.getElementById(id).offsetTop\n    }\n    this.getElemBottomPos = function (id){\n        return document.getElementById(id).offsetTop + document.getElementById(id).clientHeight\n    }\n    this.setNowPos = function (nowPos){\n        document.getElementById('chat_box').scrollTop = nowPos\n    }\n    this.getBottomPos = function (){\n        var chatBoxElem = document.getElementById('chat_box')\n        return chatBoxElem.scrollHeight - chatBoxElem.clientHeight\n    }\n    this.isBottom = function (){\n        var chatBoxElem = document.getElementById('chat_box')\n        return (chatBoxElem.scrollHeight - chatBoxElem.clientHeight - chatBoxElem.scrollTop <= 0)\n    }\n    this.scrollToPos = function (pos, isScrollDown){\n\n        // 默認滾動到底部\n        var target_pos = pos || this.getBottomPos()\n        if (!$rootScope.isMobile){\n            angular.element(document.getElementById('chat_box'))\n            .scrollTo(0, target_pos, 171)\n            .then(function(){\n                isScrollDown = false\n            })\n        } else {\n            this.setNowPos(target_pos)\n        }\n    }\n}])","angular.module('ShinyaApp.timeHelperServices', [])\n.service('syTimeHelper', function(){\n\n    // 用戶註冊當日時刻\n    this.partsOfADay = function (hour) {\n\n        if (hour <= 3){\n            return '深夜'\n        } else if (hour <= 6){\n            return '破曉'\n        } else if (hour <= 9){\n            return '早晨'\n        } else if (hour <= 12){\n            return '午前'\n        } else if (hour <= 15){\n            return '午後'\n        } else if (hour <= 18){\n            return '傍晚'\n        } else if (hour <= 21){\n            return '薄暮'\n        } else {\n            return '深夜'\n        }\n    },\n    // 用戶註冊次序號\n    this.getNumero = function (numero){\n\n        if (numero < 77){\n            return 'gold'\n        } else if(numero < 177){\n            return 'aluminum'\n        } else {\n            return 'steel'\n        }\n    },\n    // 判斷「白天」／「夜晚」\n    this.getDaytimeOrNight = function (hour){\n\n        return 6 < hour && hour < 18\n        ? 'daytime'\n        : 'night'\n    },\n    this.isSameDay = function (now, last){\n        \n        var now  = new Date(now),\n            last = new Date(last);\n            getTodayMs = function (date){\n                return Date.UTC(\n                        date.getUTCFullYear(),\n                        date.getUTCMonth(),\n                        date.getUTCDate()\n                    )\n            }\n        return getTodayMs(now) === getTodayMs(last)\n    }\n})"],"sourceRoot":"/source/"}